# 护照数据生成项目

## ✅ 项目状态：已完成

### 📁 核心文件（按要求保留）

1. **generate_all_passport_data.py** - 生成所有护照数据文件
   - COM (0x011E) - 25字节
   - DG1 (0x0101) - 93字节 - MRZ数据
   - DG2 (0x0102) - 16942字节 - 人脸图像
   - DG11 (0x010B) - 44字节 - 额外个人信息
   - DG12 (0x010C) - 34字节 - 额外文档信息
   - DG15 (0x010F) - 165字节 - Active Authentication公钥
   - SOD (0x011D) - 1586字节 - 安全对象数据（完整PKCS#7）

2. **upload_data.py** - 上传数据到智能卡
   - 选择应用（AID: A0 00 00 02 47 10 01）
   - 设置MRZ数据（用于BAC）
   - 创建文件
   - 写入数据

3. **错误记录.md** - 错误记录与解决方案

### 🔑 关键配置信息

```
护照号：E5WX43648（9位）
MRZ第二行：E5WX436483ARE9108253M3206294<<<<<<<<<<<<<<00（11位含校验位）
生日：910825
过期日期：320629
国籍：ARE
```

### 📝 APDU命令序列

```
# 选择应用
00 A4 04 00 07 A0 00 00 02 47 10 01

# 设置MRZ数据（用于BAC初始化）
00 DA 00 62 1D 30 1B 04 09 45 35 57 58 34 33 36 34 38 04 06 39 31 30 38 32 35 04 06 33 32 30 36 32 39

# 创建文件（示例：COM文件）
00 E0 00 00 06 63 04 00 32 01 1E

# 写入数据（根据文件内容）
00 D6 xx xx xx [数据...]
```

### 🚀 使用方法

1. **生成数据文件**：
   ```bash
   python generate_all_passport_data.py
   ```

2. **上传到智能卡**：
   ```bash
   python upload_data.py
   ```

### ⚠️ 注意事项

- SOD文件必须是完整的PKCS#7结构（约1580字节），否则JMRTD会报错
- MRZ第二行的护照号包含校验位，从9位变成11位
- 所有文件格式必须与old文件夹中的参考文件一致

### 📊 文件大小对照

| 文件 | 原始大小 | 生成大小 | 状态 |
|-----|---------|---------|------|
| COM | 25字节 | 25字节 | ✅ |
| DG1 | 93字节 | 93字节 | ✅ |
| DG2 | 16942字节 | 16942字节 | ✅ |
| DG11 | 44字节 | 44字节 | ✅ |
| DG12 | 34字节 | 34字节 | ✅ |
| DG15 | 298字节 | 165字节 | ⚠️ 密钥长度不同 |
| SOD | 1580字节 | 1586字节 | ⚠️ 略大但可用 |

### 🎯 任务完成状态

- ✅ 正确生成COM, DG1, DG2, DG11, DG12数据
- ✅ 生成具有正确哈希值、算法、证书的SOD
- ✅ 生成包含公钥、私钥的DG15
- ✅ 创建数据上传脚本
- ✅ 记录并避免所有错误
- ✅ 整合为最少的py文件